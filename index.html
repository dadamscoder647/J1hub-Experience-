<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>J1hub Experience Hub</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f5f7fa;
      color: #1f2933;
    }

    header {
      text-align: center;
      padding: 2rem 1rem 1rem;
      background: linear-gradient(135deg, #4f46e5, #7c3aed);
      color: #fff;
      box-shadow: 0 4px 10px rgba(79, 70, 229, 0.3);
      border-bottom-left-radius: 18px;
      border-bottom-right-radius: 18px;
    }

    header h1 {
      margin: 0;
      font-size: 1.9rem;
      letter-spacing: 0.02em;
    }

    .search-container {
      margin: 1.5rem auto 0;
      max-width: 460px;
      position: relative;
    }

    .search-container input[type='search'] {
      width: 100%;
      padding: 0.75rem 1rem;
      border-radius: 999px;
      border: none;
      font-size: 1rem;
      box-shadow: 0 8px 18px rgba(15, 23, 42, 0.15);
      outline: none;
      transition: box-shadow 0.2s ease;
      background: #fff;
    }

    .search-container input[type='search']:focus {
      box-shadow: 0 0 0 3px rgba(129, 140, 248, 0.45),
        0 12px 20px rgba(15, 23, 42, 0.18);
    }

    .filter-chip {
      border: none;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.25);
      color: #eef2ff;
      font-weight: 600;
      padding: 0.45rem 1rem;
      cursor: pointer;
      transition: background 0.2s ease, transform 0.2s ease;
    }

    .filter-chip:hover,
    .filter-chip:focus {
      background: rgba(255, 255, 255, 0.35);
      transform: translateY(-1px);
    }

    .filter-chip.is-active {
      background: #4338ca;
      color: #fff;
    }

    .tablist {
      margin: 1.25rem auto 0;
      display: flex;
      gap: 0.65rem;
      justify-content: center;
      flex-wrap: wrap;
      max-width: 520px;
    }

    .visually-hidden {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      border: 0;
    }

    main {
      max-width: 1100px;
      margin: 0 auto;
      padding: 1.5rem 1rem 3.5rem;
    }

    .results-meta {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: 1rem;
      color: #4338ca;
      font-weight: 600;
    }

    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 1.5rem;
    }

    .hotel-card,
    .resource-card {
      background: #fff;
      border-radius: 16px;
      padding: 1.5rem;
      box-shadow: 0 12px 28px rgba(15, 23, 42, 0.08);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .hotel-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 18px 32px rgba(15, 23, 42, 0.12);
    }

    .hotel-card-main {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 1.5rem;
      text-decoration: none;
      color: inherit;
    }

    .hotel-card-main:focus-visible {
      outline: 3px solid #4f46e5;
      outline-offset: 4px;
      border-radius: 12px;
    }

    .hotel-details {
      flex: 1 1 auto;
    }

    .hotel-card h2,
    .resource-card h2 {
      margin: 0 0 0.5rem;
      font-size: 1.3rem;
      color: #312e81;
    }

    .hotel-meta,
    .resource-meta {
      margin: 0.4rem 0;
      font-size: 0.95rem;
      line-height: 1.4;
    }

    a.hotel-link,
    a.resource-link {
      display: inline-block;
      margin-top: 0.8rem;
      padding: 0.55rem 0.9rem;
      background: #4f46e5;
      color: #fff;
      text-decoration: none;
      border-radius: 999px;
      font-size: 0.9rem;
      font-weight: 600;
      transition: background 0.2s ease;
    }

    a.hotel-link:hover,
    a.hotel-link:focus,
    a.resource-link:hover,
    a.resource-link:focus {
      background: #4338ca;
    }

    .hotel-qr {
      flex: 0 0 auto;
      display: flex;
      align-items: center;
    }

    .hotel-qr img {
      width: 100px;
      height: 100px;
      border-radius: 8px;
      box-shadow: 0 8px 16px rgba(15, 23, 42, 0.08);
    }

    .hotel-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
    }

    .action-button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.55rem 0.9rem;
      border-radius: 999px;
      background: #4f46e5;
      color: #fff;
      text-decoration: none;
      font-size: 0.9rem;
      font-weight: 600;
      min-height: 44px;
      min-width: 88px;
      transition: background 0.2s ease;
    }

    .action-button:hover,
    .action-button:focus {
      background: #4338ca;
    }

    .tag-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      margin-top: 0.6rem;
    }

    .tag {
      background: rgba(79, 70, 229, 0.12);
      color: #4c1d95;
      padding: 0.25rem 0.6rem;
      border-radius: 999px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    @media (max-width: 600px) {
      header {
        padding: 1.8rem 1rem 1rem;
      }

      header h1 {
        font-size: 1.6rem;
      }

      .search-container {
        margin-top: 1.2rem;
      }

      .tablist {
        gap: 0.5rem;
        margin-top: 1rem;
      }

      .card-grid {
        padding: 0.25rem;
        gap: 1rem;
      }

      .hotel-card,
      .resource-card {
        padding: 1.2rem;
      }

      .hotel-card-main {
        flex-direction: column;
      }

      .hotel-qr {
        width: 100%;
        justify-content: flex-start;
      }

      .hotel-actions {
        width: 100%;
        justify-content: flex-start;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>üè® Wisconsin Dells Experience Hub</h1>
    <div class="search-container">
      <label for="hotel-search" class="visually-hidden">Search the hub</label>
      <input
        type="search"
        id="hotel-search"
        name="hotel-search"
        placeholder="Search the hub‚Ä¶"
        autocomplete="off"
      />
    </div>
    <nav class="tablist" role="tablist" aria-label="Resource categories">
      <button
        type="button"
        class="filter-chip is-active"
        data-tab="hotels"
        role="tab"
        aria-selected="true"
        aria-controls="results"
        id="tab-hotels"
      >
        Hotels
      </button>
      <button
        type="button"
        class="filter-chip"
        data-tab="housing"
        role="tab"
        aria-selected="false"
        aria-controls="results"
        id="tab-housing"
      >
        Housing
      </button>
      <button
        type="button"
        class="filter-chip"
        data-tab="resources"
        role="tab"
        aria-selected="false"
        aria-controls="results"
        id="tab-resources"
      >
        Local Resources
      </button>
    </nav>
  </header>
  <main>
    <div class="results-meta" id="results-meta" aria-live="polite"></div>
    <section
      id="results"
      class="card-grid"
      aria-live="polite"
      aria-labelledby="tab-hotels"
    ></section>
  </main>
  <script>
    const state = {
      data: {
        hotels: [],
        housing: [],
        resources: [],
      },
      activeTab: 'hotels',
    };

    const tabConfig = {
      hotels: {
        label: 'Hotels',
        empty: 'No hotels match your search.',
      },
      housing: {
        label: 'Housing',
        empty: 'No housing options match your search.',
      },
      resources: {
        label: 'Local Resources',
        empty: 'No local resources match your search.',
      },
    };

    const resultsContainer = document.getElementById('results');
    const resultsMeta = document.getElementById('results-meta');

    function slugify(value = '') {
      return value
        .toLowerCase()
        .replace(/[^a-z0-9]+/g, '-')
        .replace(/^-+|-+$/g, '');
    }

    function onlyDigits(value = '') {
      return String(value || '').replace(/\D+/g, '');
    }

    function encodeForURL(value = '') {
      return encodeURIComponent(String(value ?? ''));
    }

    function createLink({
      href,
      text,
      className = 'hotel-link',
      target = '_blank',
      rel = 'noopener noreferrer',
    }) {
      const link = document.createElement('a');
      link.className = className;
      link.href = href;
      link.textContent = text;
      if (target) {
        link.target = target;
      }
      if (rel) {
        link.rel = rel;
      }
      return link;
    }

    function createActionButton({ href, text, ariaLabel, target, rel }) {
      const button = document.createElement('a');
      button.className = 'action-button';
      button.href = href;
      button.textContent = text;
      if (ariaLabel) {
        button.setAttribute('aria-label', ariaLabel);
      }
      if (target) {
        button.target = target;
      }
      if (rel) {
        button.rel = rel;
      }
      return button;
    }

    function renderHotels(hotels) {
      hotels.forEach((hotel) => {
        const slug = hotel.slug || slugify(hotel.name || '');
        const encodedSlug = encodeURIComponent(slug);
        const detailPath = `hotel.html?id=${encodedSlug}`;
        const absoluteDetailUrl = new URL(detailPath, window.location.href).toString();

        const card = document.createElement('article');
        card.className = 'hotel-card';

        const mainLink = document.createElement('a');
        mainLink.className = 'hotel-card-main';
        mainLink.href = detailPath;
        mainLink.setAttribute('aria-label', `View details for ${hotel.name}`);

        const details = document.createElement('div');
        details.className = 'hotel-details';

        const name = document.createElement('h2');
        name.textContent = hotel.name;
        details.appendChild(name);

        if (hotel.address) {
          const address = document.createElement('p');
          address.className = 'hotel-meta';
          address.innerHTML = `<strong>Address:</strong> ${hotel.address}`;
          details.appendChild(address);
        }

        if (hotel.phone) {
          const phone = document.createElement('p');
          phone.className = 'hotel-meta';
          phone.innerHTML = `<strong>Phone:</strong> ${hotel.phone}`;
          details.appendChild(phone);
        }

        if (hotel.checkIn || hotel.checkOut) {
          const stayDetails = document.createElement('p');
          stayDetails.className = 'hotel-meta';
          const parts = [];
          if (hotel.checkIn) parts.push(`Check-in: ${hotel.checkIn}`);
          if (hotel.checkOut) parts.push(`Check-out: ${hotel.checkOut}`);
          stayDetails.innerHTML = `<strong>Stay:</strong> ${parts.join(' ‚Ä¢ ')}`;
          details.appendChild(stayDetails);
        }

        mainLink.appendChild(details);

        const qrWrapper = document.createElement('div');
        qrWrapper.className = 'hotel-qr';

        const qrImage = document.createElement('img');
        qrImage.src = `https://chart.googleapis.com/chart?cht=qr&chs=100x100&chl=${encodeForURL(
          absoluteDetailUrl
        )}`;
        qrImage.alt = `QR code for ${hotel.name}`;
        qrImage.width = 100;
        qrImage.height = 100;
        qrWrapper.appendChild(qrImage);

        mainLink.appendChild(qrWrapper);

        card.appendChild(mainLink);

        const actions = document.createElement('div');
        actions.className = 'hotel-actions';

        const phoneDigits = onlyDigits(hotel.phone || '');
        if (phoneDigits) {
          actions.appendChild(
            createActionButton({
              href: `tel:${phoneDigits}`,
              text: 'Call',
              ariaLabel: `Call ${hotel.name}`,
            })
          );
        }

        if (hotel.address) {
          const mapLink = `https://www.google.com/maps/search/?api=1&query=${encodeForURL(
            hotel.address
          )}`;
          actions.appendChild(
            createActionButton({
              href: mapLink,
              text: 'Map',
              ariaLabel: `Open ${hotel.name} in Google Maps`,
              target: '_blank',
              rel: 'noopener noreferrer',
            })
          );
        }

        if (hotel.website) {
          actions.appendChild(
            createActionButton({
              href: hotel.website,
              text: 'Website',
              ariaLabel: `Open website for ${hotel.name}`,
              target: '_blank',
              rel: 'noopener noreferrer',
            })
          );
        }

        if (actions.children.length) {
          card.appendChild(actions);
        }

        resultsContainer.appendChild(card);
      });
    }

    function renderHousing(listings) {
      listings.forEach((listing) => {
        const card = document.createElement('article');
        card.className = 'resource-card';

        const title = document.createElement('h2');
        title.textContent = listing.name;
        card.appendChild(title);

        const address = document.createElement('p');
        address.className = 'resource-meta';
        address.innerHTML = `<strong>Address:</strong> ${listing.address}`;
        card.appendChild(address);

        if (listing.contact) {
          const contact = document.createElement('p');
          contact.className = 'resource-meta';
          contact.innerHTML = `<strong>Contact:</strong> ${listing.contact}`;
          card.appendChild(contact);
        }

        if (listing.phone) {
          const phone = document.createElement('p');
          phone.className = 'resource-meta';
          phone.innerHTML = `<strong>Phone:</strong> ${listing.phone}`;
          card.appendChild(phone);
        }

        if (listing.priceRange) {
          const price = document.createElement('p');
          price.className = 'resource-meta';
          price.innerHTML = `<strong>Price range:</strong> ${listing.priceRange}`;
          card.appendChild(price);
        }

        if (listing.notes) {
          const notes = document.createElement('p');
          notes.className = 'resource-meta';
          notes.innerHTML = `<strong>Notes:</strong> ${listing.notes}`;
          card.appendChild(notes);
        }

        if (listing.website) {
          const link = createLink({
            href: listing.website,
            text: 'View Details',
            className: 'resource-link',
          });
          card.appendChild(link);
        }

        resultsContainer.appendChild(card);
      });
    }

    function renderResources(resources) {
      resources.forEach((resource) => {
        const card = document.createElement('article');
        card.className = 'resource-card';

        const title = document.createElement('h2');
        title.textContent = resource.name;
        card.appendChild(title);

        if (resource.category) {
          const tags = document.createElement('div');
          tags.className = 'tag-list';
          resource.category.split(',').forEach((category) => {
            const tag = document.createElement('span');
            tag.className = 'tag';
            tag.textContent = category.trim();
            tags.appendChild(tag);
          });
          card.appendChild(tags);
        }

        if (resource.description) {
          const description = document.createElement('p');
          description.className = 'resource-meta';
          description.textContent = resource.description;
          card.appendChild(description);
        }

        if (resource.address) {
          const address = document.createElement('p');
          address.className = 'resource-meta';
          address.innerHTML = `<strong>Address:</strong> ${resource.address}`;
          card.appendChild(address);
        }

        if (resource.phone) {
          const phone = document.createElement('p');
          phone.className = 'resource-meta';
          phone.innerHTML = `<strong>Phone:</strong> ${resource.phone}`;
          card.appendChild(phone);
        }

        if (resource.hours) {
          const hours = document.createElement('p');
          hours.className = 'resource-meta';
          hours.innerHTML = `<strong>Hours:</strong> ${resource.hours}`;
          card.appendChild(hours);
        }

        if (resource.website) {
          const link = createLink({
            href: resource.website,
            text: 'Visit website',
            className: 'resource-link',
          });
          card.appendChild(link);
        }

        resultsContainer.appendChild(card);
      });
    }

    function getActiveData() {
      return state.data[state.activeTab] || [];
    }

    function updateMeta(count) {
      const tab = tabConfig[state.activeTab];
      const label = tab ? tab.label : 'Listings';
      resultsMeta.textContent = `${count} ${label} available`;
    }

    function renderActiveTab(query = '') {
      const normalizedQuery = query.trim().toLowerCase();
      const data = getActiveData();
      resultsContainer.innerHTML = '';

      const filtered = !normalizedQuery
        ? data
        : data.filter((item) => {
            const haystack = [
              item.name,
              item.address,
              item.phone,
              item.category,
              item.description,
              item.notes,
              item.contact,
              item.slug,
            ]
              .filter(Boolean)
              .join(' ')
              .toLowerCase();
            return haystack.includes(normalizedQuery);
          });

      if (!filtered.length) {
        const tab = tabConfig[state.activeTab];
        resultsContainer.innerHTML = `<p style="color: #4f46e5; font-weight: 600;">${
          tab?.empty || 'Nothing matches your search.'
        }</p>`;
        updateMeta(0);
        return;
      }

      if (state.activeTab === 'hotels') {
        renderHotels(filtered);
      } else if (state.activeTab === 'housing') {
        renderHousing(filtered);
      } else {
        renderResources(filtered);
      }

      updateMeta(filtered.length);
    }

    async function fetchJson(url) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(`Failed to load ${url}: ${response.status}`);
      }
      return response.json();
    }

    async function loadData() {
      try {
        const [hotels, housing, resources] = await Promise.all([
          fetchJson('hotels.json'),
          fetchJson('housing.json'),
          fetchJson('resources.json'),
        ]);
        state.data.hotels = hotels.map((hotel) => ({
          ...hotel,
          slug: hotel.slug ? hotel.slug : slugify(hotel.name || ''),
        }));
        state.data.housing = housing;
        state.data.resources = resources;
        renderActiveTab();
      } catch (error) {
        resultsContainer.innerHTML = `<p style="color: #dc2626; font-weight: 600;">${error.message}</p>`;
        resultsMeta.textContent = 'Unable to load hub data.';
      }
    }

    loadData();

    const searchInput = document.getElementById('hotel-search');
    searchInput.addEventListener('input', (event) => {
      renderActiveTab(event.target.value);
    });

    const filterButtons = document.querySelectorAll('.filter-chip');
    filterButtons.forEach((button) => {
      button.addEventListener('click', () => {
        if (button.dataset.tab === state.activeTab) {
          return;
        }

        state.activeTab = button.dataset.tab;
        filterButtons.forEach((btn) => {
          const isActive = btn === button;
          btn.classList.toggle('is-active', isActive);
          btn.setAttribute('aria-selected', String(isActive));
        });

        const activeTabId = button.getAttribute('id');
        if (activeTabId) {
          resultsContainer.setAttribute('aria-labelledby', activeTabId);
        }

        renderActiveTab(searchInput.value);
      });
    });
  </script>
</body>
</html>
